(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["login","chunk-7dd84fae","chunk-43418c31"],{"0631":function(e,t,r){var n=r("c20f"),a=r("2f85"),o=r("184b"),s="[object DOMException]",u="[object Error]";function i(e){if(!a(e))return!1;var t=n(e);return t==u||t==s||"string"==typeof e.message&&"string"==typeof e.name&&!o(e)}e.exports=i},3824:function(e,t,r){var n=r("ff23"),a=9007199254740991;function o(e){return n(e)&&e>=-a&&e<=a}e.exports=o},"6e9e":function(e,t,r){e.exports=r.p+"static/img/logo.90548f1e.png"},"746d":function(e,t,r){"use strict";var n=r("8007"),a=r.n(n);t["default"]=a.a},8007:function(e,t,r){e.exports={page:"login-1eb6978c9fd5e5a989ea517c38db69ed",header:"login-b9fd8469400d55d37d0474a695103789",logo:"login-02937a268d81fbf0660c7e7ef8b3a79f",image:"login-74b45c6c85d97c3a4bbb08e131d38c6e",text:"login-44ddd852298ea7843ceb8c821c956ddd",navbar:"login-ec20de5a9c885ffd31e07ce97cffcf16",body:"login-bdc928064866626a2f3c407e12838fc9",formBox:"login-667d209e93881811a4de6a32d032fd91",title:"login-8366cf1050a1843a3eba263268153943",footer:"login-2f023a760a7bb4e9a51823aa3afbc4ec"}},"9e77":function(e,t,r){"use strict";r.r(t);var n=r("e1d2"),a=n["a"].makeBaseRequestIns(),o={getRoleMenus:function(){return a.get("/menus/roleMenus")}};t["default"]=o},b479:function(e,t,r){"use strict";r.r(t);var n=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("cd-page",{class:e.$style.page},[n("header",{class:e.$style.header},[n("a",{class:e.$style.logo},[n("img",{class:e.$style.image,attrs:{src:r("6e9e"),alt:"logo"}}),n("span",{class:e.$style.text},[e._v("CBMP 易捷云核心新业务管控平台")])]),n("div",{class:e.$style.navbar},[n("a",{attrs:{href:""}},[e._v("注册")])])]),n("section",{class:e.$style.body},[n("el-form",{ref:"form",class:e.$style.formBox,attrs:{model:e.model,rules:e.rules},nativeOn:{submit:function(t){return t.preventDefault(),e.submit(t)}}},[n("p",{class:e.$style.title},[e._v("登录")]),n("el-form-item",{attrs:{prop:"username"}},[n("el-input",{attrs:{placeholder:"账号",size:"medium"},model:{value:e.model.username,callback:function(t){e.$set(e.model,"username",t)},expression:"model.username"}})],1),n("el-form-item",{attrs:{prop:"password"}},[n("el-input",{attrs:{placeholder:"密码",type:"password",size:"medium"},model:{value:e.model.password,callback:function(t){e.$set(e.model,"password",t)},expression:"model.password"}})],1),n("el-row",[n("el-col",{attrs:{span:12}},[n("el-form-item",[n("el-checkbox",{model:{value:e.model.savePsw,callback:function(t){e.$set(e.model,"savePsw",t)},expression:"model.savePsw"}}),e._v("\n              记住密码\n          ")],1)],1),n("el-col",{staticStyle:{"text-align":"right"},attrs:{span:12}},[n("el-form-item",[n("a",[e._v("注册")]),e._v("\n              |  \n            "),n("a",[e._v("忘记密码")])])],1)],1),n("el-row",[n("cd-button",{attrs:{type:"primary","native-type":"submit",long:"",size:"medium"}},[e._v("登录")])],1)],1),n("footer",{class:e.$style.footer},[n("a",{attrs:{href:"http://www.miitbeian.gov.cn/",target:"_blank"}},[e._v("沪ICP备14039535号-14")]),e._v("\n         Copyright©2018 深圳易捷云科技有限公司\n    ")])],1)])},a=[],o=r("f27c"),s=r.n(o),u=r("cf93"),i=r("0162"),c=r("f087"),l=r("9e77");function f(e,t){return h(e)||d(e,t)||p()}function p(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function d(e,t){var r=[],n=!0,a=!1,o=void 0;try{for(var s,u=e[Symbol.iterator]();!(n=(s=u.next()).done);n=!0)if(r.push(s.value),t&&r.length===t)break}catch(i){a=!0,o=i}finally{try{n||null==u["return"]||u["return"]()}finally{if(a)throw o}}return r}function h(e){if(Array.isArray(e))return e}function v(e,t,r,n,a,o,s){try{var u=e[o](s),i=u.value}catch(c){return void r(c)}u.done?t(i):Promise.resolve(i).then(n,a)}function w(e){return function(){var t=this,r=arguments;return new Promise(function(n,a){var o=e.apply(t,r);function s(e){v(o,n,a,s,u,"next",e)}function u(e){v(o,n,a,s,u,"throw",e)}s(void 0)})}}var m={name:"Login",components:{CdPage:u["CdPage"],CdPanel:u["CdPanel"]},data:function(){var e=this;return{rules:{username:[{required:!0,message:"请输入账号",trigger:"blur"},{validator:e.makeValidator_(function(){var e=w(s.a.mark(function e(t,r){return s.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(!i["a"].string.isAccount(r)){e.next=2;break}return e.abrupt("return",!0);case 2:throw new Error("请输入合法的账号");case 3:case"end":return e.stop()}},e)}));return function(t,r){return e.apply(this,arguments)}}()),trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:6,max:15,message:"长度在 6 到 15 个字符",trigger:"blur"}]},model:{username:"",password:"",savePsw:""}}},computed:{},methods:{submit:function(){var e=w(s.a.mark(function e(){var t=this;return s.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.$refs.form.validate();case 3:e.next=9;break;case 5:return e.prev=5,e.t0=e["catch"](0),this.$message.warn("输入信息有误"),e.abrupt("return");case 9:return e.next=11,this.withLoading_(w(s.a.mark(function e(){var r,n,a,o,u;return s.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,c["default"].login(t.model);case 2:return r=e.sent,t.setUserAuthInfo_(r),e.next=6,Promise.all([c["default"].getCurrentUser(),l["default"].getRoleMenus()]);case 6:n=e.sent,a=f(n,2),o=a[0],u=a[1],t.setUserBaseInfo_(o),t.setMenuList_(u);case 12:case"end":return e.stop()}},e)})));case 11:this.push_("/");case 12:case"end":return e.stop()}},e,this,[[0,5]])}));function t(){return e.apply(this,arguments)}return t}()},created:function(){}},g=m,b=r("746d"),y=r("17cc");function k(e){this["$style"]=b["default"].locals||b["default"]}var x=Object(y["a"])(g,n,a,!1,k,null,null);t["default"]=x.exports},e1d2:function(e,t,r){"use strict";r.d(t,"a",function(){return E});var n=r("f27c"),a=r.n(n),o=r("03c7"),s=r.n(o),u=r("2499"),i=r.n(u),c=r("c83a"),l=r.n(c),f=r("2901"),p=r.n(f),d=r("0631"),h=r.n(d),v=r("3824"),w=r.n(v),m=r("bf92"),g=r.n(m),b=r("7f43"),y=r.n(b),k=r("5ee4"),x=r.n(k),_=r("0162");function I(e,t,r,n,a,o,s){try{var u=e[o](s),i=u.value}catch(c){return void r(c)}u.done?t(i):Promise.resolve(i).then(n,a)}function R(e){return function(){var t=this,r=arguments;return new Promise(function(n,a){var o=e.apply(t,r);function s(e){I(o,n,a,s,u,"next",e)}function u(e){I(o,n,a,s,u,"throw",e)}s(void 0)})}}function $(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function q(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function U(e,t,r){return t&&q(e.prototype,t),r&&q(e,r),e}function P(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function T(){return window.$h.apiErrorPrefix||"__HSCF__ERROR__"}y.a.defaults.paramsSerializer=function(e){return x.a.stringify(e)};var E=function(){function e(t){var r=t.baseUrl,n=t.timeout,a=t.option,o=void 0===a?{}:a,s=t.requestSuccessInterceptor,u=void 0===s?e.authRequestInterceptor:s,i=t.requestErrorInterceptor,c=void 0===i?e.errorInterceptor:i,l=t.responseSuccessInterceptor,f=void 0===l?e.hscfResponseInterceptor:l,p=t.responseErrorInterceptor,d=void 0===p?e.errorInterceptor:p;$(this,e);var h=o;h.baseURL=r||o.baseUrl||e.getDefaultBaseUrl(),h.timeout=n||o.timeout||window.$h.requestTimeout,h.headers=o.headers||{},h.headers["Content-Type"]=o.headers["Content-Type"]||"application/json",this.option=h,this.axios=y.a.create(h),this.axios.interceptors.request.use(u,c),this.axios.interceptors.response.use(f,d)}return U(e,[{key:"getRequest",value:function(){return this.axios}}],[{key:"getDefaultBaseUrl",value:function(){return window.$h.baseUrl}},{key:"unauthRequestInterceptor",value:function(){var e=R(a.a.mark(function e(t){return a.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",t);case 1:case"end":return e.stop()}},e)}));function t(t){return e.apply(this,arguments)}return t}()},{key:"authRequestInterceptor",value:function(){var t=R(a.a.mark(function t(r){var n,o;return a.a.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(n=r,!n.$notPermission){t.next=3;break}return t.abrupt("return",n);case 3:return t.prev=3,t.next=6,e._getToken();case 6:return o=t.sent,g()(n,"headers.Authorization",o),t.abrupt("return",n);case 11:throw t.prev=11,t.t0=t["catch"](3),new Error("".concat(T(),"L401-").concat(t.t0.message));case 14:case"end":return t.stop()}},t,null,[[3,11]])}));function r(e){return t.apply(this,arguments)}return r}()},{key:"_getToken",value:function(){var t=R(a.a.mark(function t(){var r,n,o,s,u,i,c,l,f;return a.a.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(r=window.$h.getAuthInfo()||{},n=r.refreshToken,o=r.accessToken,s=r.lastUpdateTime,u=r.expiresIn,o){t.next=4;break}throw e._login(),new Error("你尚未登录,正在跳转到登录页面");case 4:if(n&&w()(s)&&w()(u)){t.next=6;break}return t.abrupt("return",o);case 6:if(i=(new Date).getTime(),c=i-s>=u-window.$h.refreshTokenTolerantTime,c){t.next=10;break}return t.abrupt("return",o);case 10:return e._refreshToken||(e._refreshToken=y.a.post("/auth/token",{grant_type:"refresh_token",refresh_token:n,client_secret:window.$h.clientSecret,client_id:window.$h.clientId},{baseURL:window.$h.authUrl,timeout:window.$h.requestTimeout,transformRequest:[function(e){return x.a.stringify(e)}],headers:{"Content-Type":"application/x-www-form-urlencoded"}})),t.next=13,e._refreshToken;case 13:return l=t.sent,f=l.data,window.$h.bus.emit("setLoginInfo",{refreshToken:f.refresh_token,accessToken:f.access_token,lastUpdateTime:(new Date).getTime(),expiresIn:1e3*f.expires_in,scope:f.scope}),t.abrupt("return",o);case 17:case"end":return t.stop()}},t)}));function r(){return t.apply(this,arguments)}return r}()},{key:"_logout",value:function(){window.$h.bus.emit("logout")}},{key:"_login",value:function(){window.$h.bus.emit("login")}},{key:"_handleUnauthorized",value:function(){throw e._logout(),new Error("".concat(T(),"401-无权限，请重新登录"))}},{key:"makeRequestIns",value:function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window.$h.requestTimeout;if(p()(t))return new e({baseUrl:t,timeout:r}).getRequest();var n=t;return new e(n).getRequest()}},{key:"makeBaseRequestIns",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t;return r.baseUrl=window.$h.baseUrl,new e(r).getRequest()}},{key:"makeBaseRequestInsWithUnauth",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t;return r.baseUrl=window.$h.baseUrl,r.requestSuccessInterceptor=e.unauthRequestInterceptor,new e(r).getRequest()}},{key:"makeAuthRequestInsWithUnauthAndPlain",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t;r.baseUrl=window.$h.authUrl,r.requestSuccessInterceptor=e.unauthRequestInterceptor,r.responseSuccessInterceptor=e.plainDataResponseInterceptor;var n=new e(r).getRequest();return n}},{key:"makePagingRequest",value:function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0,a=arguments.length>3?arguments[3]:void 0;return function(){var o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},u=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10,c=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],l=o;if(l.pageNum=u,l.pageSize=i,c){var f=c.filter(function(e){return!s()(e.order)}).sort(function(e,t){return e.order-t.order}).map(function(e){return'"'.concat(e.prop,'":"').concat(e.order,'"')}),p="{".concat(f.join(","),"}");l._sortColumn=encodeURIComponent(p)}n&&(l=n(l));var d=r;d.params=l;var h=a||e.makeBaseRequestIns();return h.get(t,d)}}},{key:"makeFormDataRequest",value:function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0,a=arguments.length>3?arguments[3]:void 0;return function(o){var s,u=t,c=r;if(i()(c,"headers.Content-Type")||g()(c,"headers.Content-Type","multipart/form-data"),n){var l=n(o,r),f=l.url,p=l.formData,d=l.option;s=p,u=f,c=d}else s=new FormData,Object.keys(o).forEach(function(e){s.append(e,o[e])});var h=a||e.makeBaseRequestIns(),v=h.post(u,s,c);return v}}},{key:"makeUploadRequest",value:function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0,a=arguments.length>3?arguments[3]:void 0;return function(o,s){var u,i=r;i.onUploadProgress=function(e){s(e)},i.cancelToken=new y.a.CancelToken(function(e){u=e});var c=e.makeFormDataRequest(t,i,n,a)(o);return c.abort=u,c}}}]),e}();P(E,"errorInterceptor",function(){var e=R(a.a.mark(function e(t){var r,n,o,s;return a.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(r=t,h()(t)&&"Request failed with status code 401"===t.message)try{E._handleUnauthorized()}catch(n){r=n}throw p()(r)&&(r=new Error(r)),n=null,n=l()(r.message,T())?new Error(r.message.replace(T(),"")):new Error("L500-网络异常，发送请求失败"),o=n.message.split("-")[1],s=i()(window,"$c.$message.error"),s&&s(o),n;case 9:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),P(E,"hscfResponseInterceptor",function(){var e=R(a.a.mark(function e(t){var r;return a.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,_["a"].lang.strategy({200:function(){var e=R(a.a.mark(function e(){var r,n,o;return a.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return r=t.data,n={200:function(){var e=R(a.a.mark(function e(){return a.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",r.data);case 1:case"end":return e.stop()}},e)}));function t(){return e.apply(this,arguments)}return t}(),401:E._handleUnauthorized,700:function(){var e=R(a.a.mark(function e(){return a.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:throw E._logout(),new Error("".concat(T(),"700-").concat(r.message));case 2:case"end":return e.stop()}},e)}));function t(){return e.apply(this,arguments)}return t}(),760:function(){var e=R(a.a.mark(function e(){var t,n;return a.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(t=i()(window,"$c.$message"),t&&t.closeAll(),n=i()(window,"$c.$confirm"),!n){e.next=6;break}return e.next=6,n(r.message,"提示",{confirmButtonText:"确定",type:"warning",showCancelButton:!1,closeOnClickModal:!1,closeOnPressEscape:!1});case 6:throw E._logout(),new Error("".concat(T(),"760-").concat(r.message));case 8:case"end":return e.stop()}},e)}));function t(){return e.apply(this,arguments)}return t}()},e.next=4,_["a"].lang.strategy(n,String(r.code),R(a.a.mark(function e(){return a.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:throw new Error("".concat(T()).concat(r.code||"null","-").concat(r.message||"后台的数据结构有误"));case 1:case"end":return e.stop()}},e)})));case 4:return o=e.sent,e.abrupt("return",o);case 6:case"end":return e.stop()}},e)}));function r(){return e.apply(this,arguments)}return r}(),401:E._handleUnauthorized},String(t.status),R(a.a.mark(function e(){return a.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:throw new Error("".concat(T()).concat(t.status,"-网络出现错误, http状态码为:").concat(t.status));case 1:case"end":return e.stop()}},e)})));case 3:return r=e.sent,e.abrupt("return",r);case 7:return e.prev=7,e.t0=e["catch"](0),e.next=11,E.errorInterceptor(e.t0);case 11:return e.abrupt("return",null);case 12:case"end":return e.stop()}},e,null,[[0,7]])}));return function(t){return e.apply(this,arguments)}}()),P(E,"plainDataResponseInterceptor",function(){var e=R(a.a.mark(function e(t){return a.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.abrupt("return",t.data);case 4:return e.prev=4,e.t0=e["catch"](0),e.next=8,E.errorInterceptor(e.t0);case 8:return e.abrupt("return",null);case 9:case"end":return e.stop()}},e,null,[[0,4]])}));return function(t){return e.apply(this,arguments)}}())},f087:function(e,t,r){"use strict";r.r(t);var n=r("6372"),a=r("e1d2");function o(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"===typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),n.forEach(function(t){s(e,t,r[t])})}return e}function s(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var u=a["a"].makeBaseRequestIns(),i=a["a"].makeAuthRequestInsWithUnauthAndPlain(),c={getCurrentUser:function(){return u.get("/users/currentUser")},login:function(e){return i.post("/auth/token",o({grantType:"password",clientId:n["a"].clientId,clientSecret:n["a"].clientSecret,scope:""},e))}};c.listLoginLogs=a["a"].makePagingRequest("/loginLogs"),c.paging=a["a"].makePagingRequest("/users"),c.get=function(e){return u.get("/users/".concat(e))},c.add=function(e){return u.post("/users",e)},c.update=function(e){return u.put("/users",e)},t["default"]=c},ff23:function(e,t,r){var n=r("baf2");function a(e){return"number"==typeof e&&e==n(e)}e.exports=a}}]);